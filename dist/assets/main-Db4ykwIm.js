import{c as w,o as x,q as C,a as S,w as b,T as v,b as q,d as D}from"./main-IRJRTn-X.js";import"./uielement-CLyhsJix.js";/* empty css                */function T(e,t){let o=e,s=t;const a=w(D,"chats");let c=null;const y=async r=>{const u=new Date,l={username:s,room:o,message:r,created_at:v.fromDate(u)};try{return await q(a,l)}catch(d){throw console.log("Error addchat = ",d),d}};return c&&c(),{addChat:y,getChats:r=>{c=x(C(a,b("room","==",o),S("created_at")),u=>{u.docChanges().forEach(l=>{l.type==="added"&&r(l.doc.data())})})},updateChatroom:r=>{o=r},updateUsername:r=>{s=r,localStorage.setItem("username",r)}}}function L(e){return{newli:s=>{const a=dateFns.formatDistance(s.created_at.toDate(),new Date,{addSuffix:!0}),c=`
            <li class="shadow rounded-lg px-4 py-2">
                <div class="flex justify-between">
                    <h5 class="text-gray-600 font-medium text-sm">${s.username}</h5>
                    <i class="text-gray-300 text-xs">${a}</i>
                </div>
                <p class="text-gray-600 text-sm">${s.message}</p>
            </li>
        `;e.innerHTML+=c},resetli:()=>{e.innerHTML=""}}}const $=document.querySelector(".chatrooms"),E=document.querySelector(".chat-ul"),i=document.querySelector(".chat-form"),m=document.querySelector(".user-form"),g=document.querySelector(".msg"),p=document.querySelector(".roomtitle"),f=localStorage.username?localStorage.username:"Guest";m.username.placeholder=`username is ${f}`;const n=T("general",f);p.textContent="General";i.addEventListener("submit",e=>{e.preventDefault();const t=i.message.value.trim();n.addChat(t).then(()=>i.reset()).catch(o=>console.log(o))});m.addEventListener("submit",e=>{e.preventDefault();const t=m.username.value.trim();n.updateUsername(t),m.reset(),g.innerText=`New name is updated to ${t}`,m.username.placeholder=`Username is ${t}`,setTimeout(()=>g.innerText="",3e3)});$.addEventListener("click",e=>{e.preventDefault();const t=e.target.closest("button");if(t){h.resetli();const o=t.getAttribute("id"),s=t.querySelector("h3").innerText;p.textContent=s,n.updateChatroom(o),n.getChats(a=>{h.newli(a)})}});n.getChats(e=>e);const h=L(E);n.getChats(e=>{h.newli(e)});
