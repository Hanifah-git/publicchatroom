import{c as C,o as y,q as S,a as b,w as q,T as v,b as w,d as D}from"./main-BM8Fwr8O.js";import"./uielement--F2L_3Nj.js";/* empty css                */function T(t,e){let r=t,n=e;const c=C(D,"chats");let u=null;const f=async o=>{const d=new Date,m={username:n,room:r,message:o,created_at:v.fromDate(d)};try{return await w(c,m)}catch(l){throw console.log("Error addchat = ",l),l}};return u&&u(),{addChat:f,getChats:o=>{u=y(S(c,q("room","==",r),b("created_at")),d=>{d.docChanges().forEach(m=>{m.type==="added"&&o(m.doc.data())})})},updateChatroom:o=>{r=o},updateUsername:o=>{n=o,localStorage.setItem("username",o)}}}const x=document.querySelector(".chatrooms");document.querySelector(".chat-ul");const i=document.querySelector(".chat-form"),a=document.querySelector(".user-form"),h=document.querySelector(".msg"),g=document.querySelector(".roomtitle"),p=localStorage.username?localStorage.username:"Guest";a.username.placeholder=`username is ${p}`;const s=T("general",p);g.textContent="General";i.addEventListener("submit",t=>{t.preventDefault();const e=i.message.value.trim();s.addChat(e).then(()=>i.reset()).catch(r=>console.log(r))});a.addEventListener("submit",t=>{t.preventDefault();const e=a.username.value.trim();s.updateUsername(e),a.reset(),h.innerText=`New name is updated to ${e}`,a.username.placeholder=`Username is ${e}`,setTimeout(()=>h.innerText="",3e3)});x.addEventListener("click",t=>{t.preventDefault();const e=t.target.closest("button");if(e){domli.resetli();const r=e.getAttribute("id"),n=e.querySelector("h3").innerText;g.textContent=n,s.updateChatroom(r),s.getChats(c=>{domli.newli(c)})}});s.getChats(t=>t);
